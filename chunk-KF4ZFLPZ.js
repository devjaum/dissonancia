import{a as K,b as j,c as U,d as Y,f as q,g as G,h as J,i as Q}from"./chunk-ZIR2ZB4B.js";import{j as X}from"./chunk-KLQ32EPB.js";import{$ as _,A as p,B as m,Ca as L,Da as B,Ea as R,Ga as z,Ja as $,N as l,S as H,T as N,X as y,aa as o,ba as a,ca as k,da as C,ea as M,fa as d,ha as T,ia as I,ja as s,ka as V,la as v,ma as D,n as W,na as f,oa as h,pa as x,w as F}from"./chunk-YJ7IANYW.js";function ne(c,i){if(c&1){let e=C();o(0,"div",20)(1,"div",21)(2,"label"),s(3,"FOR"),a(),o(4,"input",22),x("ngModelChange",function(t){p(e);let r=d();return h(r.player.str,t)||(r.player.str=t),m(t)}),a()(),o(5,"div",21)(6,"label"),s(7,"DES"),a(),o(8,"input",22),x("ngModelChange",function(t){p(e);let r=d();return h(r.player.dex,t)||(r.player.dex=t),m(t)}),a()(),o(9,"div",21)(10,"label"),s(11,"CON"),a(),o(12,"input",22),x("ngModelChange",function(t){p(e);let r=d();return h(r.player.con,t)||(r.player.con=t),m(t)}),a()(),o(13,"div",21)(14,"label"),s(15,"INT"),a(),o(16,"input",22),x("ngModelChange",function(t){p(e);let r=d();return h(r.player.int,t)||(r.player.int=t),m(t)}),a()(),o(17,"div",21)(18,"label"),s(19,"SAB"),a(),o(20,"input",22),x("ngModelChange",function(t){p(e);let r=d();return h(r.player.wis,t)||(r.player.wis=t),m(t)}),a()(),o(21,"div",21)(22,"label"),s(23,"CAR"),a(),o(24,"input",22),x("ngModelChange",function(t){p(e);let r=d();return h(r.player.cha,t)||(r.player.cha=t),m(t)}),a()()()}if(c&2){let e=d();l(4),f("ngModel",e.player.str),l(4),f("ngModel",e.player.dex),l(4),f("ngModel",e.player.con),l(4),f("ngModel",e.player.int),l(4),f("ngModel",e.player.wis),l(4),f("ngModel",e.player.cha)}}function ie(c,i){if(c&1&&(o(0,"option",29),s(1),a()),c&2){let e=i.$implicit;_("ngValue",e),l(),v(" ",e.label," ")}}function re(c,i){if(c&1){let e=C();o(0,"div",23)(1,"div",24)(2,"label"),s(3,"Estilo de Combate:"),a(),o(4,"select",25),x("ngModelChange",function(t){p(e);let r=d();return h(r.selectedAttack,t)||(r.selectedAttack=t),m(t)}),y(5,ie,2,2,"option",26),a()(),o(6,"button",27),M("click",function(){p(e);let t=d();return m(t.performAttack(t.player,t.enemy,0,4))}),s(7),a(),o(8,"button",28),M("click",function(){p(e);let t=d();return m(t.performAttack(t.player,t.enemy,-1,6))}),s(9," \u{1F4A5} Pesado (-1 Dado, +2 Dano) "),a()()}if(c&2){let e=d();l(4),f("ngModel",e.selectedAttack),l(),_("ngForOf",e.attackOptions),l(2),v(" \u2694\uFE0F Atacar (",e.player[e.selectedAttack.attr],"d6) ")}}function oe(c,i){if(c&1){let e=C();o(0,"div",20)(1,"div",21)(2,"label"),s(3,"FOR"),a(),o(4,"input",22),x("ngModelChange",function(t){p(e);let r=d();return h(r.enemy.str,t)||(r.enemy.str=t),m(t)}),a()(),o(5,"div",21)(6,"label"),s(7,"DES"),a(),o(8,"input",22),x("ngModelChange",function(t){p(e);let r=d();return h(r.enemy.dex,t)||(r.enemy.dex=t),m(t)}),a()(),o(9,"div",21)(10,"label"),s(11,"CON"),a(),o(12,"input",22),x("ngModelChange",function(t){p(e);let r=d();return h(r.enemy.con,t)||(r.enemy.con=t),m(t)}),a()()()}if(c&2){let e=d();l(4),f("ngModel",e.enemy.str),l(4),f("ngModel",e.enemy.dex),l(4),f("ngModel",e.enemy.con)}}function ae(c,i){if(c&1){let e=C();o(0,"button",30),M("click",function(){p(e);let t=d();return m(t.startBattle())}),s(1,"INICIAR SIMULA\xC7\xC3O"),a()}}function le(c,i){if(c&1){let e=C();o(0,"button",31),M("click",function(){p(e);let t=d();return m(t.reset())}),s(1,"REINICIAR"),a()}}function se(c,i){if(c&1&&(o(0,"p",32)(1,"span",33),s(2,">>"),a(),s(3),a()),c&2){let e=i.$implicit;_("ngClass",e.type),l(3),v(" ",e.message," ")}}var Z=class c{constructor(i){this.router=i;this.calculateStats(this.player),this.calculateStats(this.enemy)}dbService=F(X);character$=this.dbService.getCharacterByEmail().pipe(W(i=>{if(!i)return null;let e=i.status||[0,0,0,0,0,0],n=Array.isArray(i.talent)?i.talent:[],t=i.name||"Her\xF3i",r=Number(e[0])||0,u=Number(e[1])||0,g=Number(e[2])||0,b=Number(e[3])||0,O=Number(e[4])||0,P=Number(e[5])||0,A=n.includes("Vigoroso"),S=i.vidaExtra||0,w=5+g*10+r*5+(A?10:0)+S,E=1+Math.max(Math.floor(u/2),Math.floor(g/2)),ee=1+Math.max(Math.floor(O/2),Math.floor(b/2)),te=u+Math.floor(Math.random()*6)+1;return{name:t,isPlayer:!0,str:r,dex:u,con:g,int:b,wis:O,cha:P,maxHp:w,currentHp:w,passiveDef:E,magicDef:ee,initiative:te}}));battleLog=[];turnTotal=0;battleStarted=!1;turnOrder=[];currentTurnIndex=0;attackOptions=[{label:"\u{1F5E1}\uFE0F Arma Leve (DES)",attr:"dex"},{label:"\u{1F528} Arma Pesada (FOR)",attr:"str"},{label:"\u{1F52E} Magia Arcana (INT)",attr:"int"},{label:"\u2728 Magia Espiritual (SAB)",attr:"wis"},{label:"\u{1F5E3}\uFE0F Encantamento (CAR)",attr:"cha"}];selectedAttack=this.attackOptions[0];player={name:"Her\xF3i",isPlayer:!0,str:3,dex:4,con:3,int:2,wis:2,cha:2,maxHp:0,currentHp:0,passiveDef:0,magicDef:0,initiative:0};ngOnInit(){this.character$.subscribe(i=>this.player=i)}enemy={name:"Sombra",isPlayer:!1,str:4,dex:2,con:3,int:1,wis:2,cha:1,maxHp:0,currentHp:0,passiveDef:0,magicDef:0,initiative:0};calculateStats(i){i.maxHp=5+i.con*10+i.str*5,i.currentHp=i.maxHp;let e=Math.floor(i.dex/2),n=Math.floor(i.con/2);i.passiveDef=1+Math.max(e,n)}rollPool(i,e=0){let n=i+e,t=[],r=0;if(n<=0){let u=Math.floor(Math.random()*6)+1,g=Math.floor(Math.random()*6)+1;return t.push(u,g),Math.min(u,g)>=4&&(r=1),{successes:r,rolls:t}}for(let u=0;u<n;u++){let g=Math.floor(Math.random()*6)+1;t.push(g),g>=4&&r++}return{successes:r,rolls:t}}startBattle(){this.calculateStats(this.player),this.calculateStats(this.enemy),this.battleLog=[],this.log("=== IN\xCDCIO DO COMBATE ===","system");let i=Math.floor(Math.random()*6)+1;this.player.initiative=this.player.dex+i,this.log(`${this.player.name} Iniciativa: ${this.player.dex} + ${i} = ${this.player.initiative}`,"player");let e=Math.floor(Math.random()*6)+1;this.enemy.initiative=this.enemy.dex+e,this.log(`${this.enemy.name} Iniciativa: ${this.enemy.dex} + ${e} = ${this.enemy.initiative}`,"enemy"),this.player.initiative>=this.enemy.initiative?(this.turnOrder=[this.player,this.enemy],this.log(`>> ${this.player.name} age primeiro!`,"system")):(this.turnOrder=[this.enemy,this.player],this.log(`>> ${this.enemy.name} age primeiro!`,"system")),this.battleStarted=!0,this.currentTurnIndex=0,this.checkTurn()}checkTurn(){let i=this.turnOrder[this.currentTurnIndex];i.isPlayer||setTimeout(()=>this.performAttack(i,this.player),1e3),i.isPlayer&&(this.turnTotal=Number(this.turnTotal)+1)}nextTurn(){this.player.currentHp<=0||this.enemy.currentHp<=0||(this.currentTurnIndex=(this.currentTurnIndex+1)%2,this.checkTurn())}performAttack(i,e,n=0,t=4){let r,u,g=i.isPlayer?"player":"enemy";i.isPlayer?(r=i[this.selectedAttack.attr],u=this.selectedAttack.label):(r=i.str>i.dex?i.str:i.dex,u=i.str>i.dex?"For\xE7a Bruta":"Agilidade"),this.log(`${i.name} usa ${u}!`,g);let{successes:b,rolls:O}=this.rollPool(r,n),P=O.join(", ");if(this.log(`\u{1F3B2} Dados: [${P}] -> ${b} Sucessos (DT ${e.passiveDef})`,"system"),b>=e.passiveDef){let S=(b-e.passiveDef)*2,w=t+S;e.currentHp-=w,e.currentHp<0&&(e.currentHp=0);let E=S>0?` (CR\xCDTICO +${S})`:"";this.log(`\u{1F4A5} ACERTOU! Dano: ${t}${E} = ${w}`,"critical")}else this.log("\u{1F4A8} ERROU! Defesa prevaleceu.","fail");this.checkWinCondition(),this.battleStarted&&this.nextTurn()}checkWinCondition(){this.player.currentHp<=0?(this.log(`Total de turnos: ${this.turnTotal}`,"system"),this.log(`\u{1F480} ${this.player.name} foi derrotado.`,"fail"),this.battleStarted=!1):this.enemy.currentHp<=0&&(this.log(`Total de turnos: ${this.turnTotal}`,"system"),this.log(`\u{1F3C6} ${this.enemy.name} foi eliminado!`,"critical"),this.battleStarted=!1)}log(i,e){this.battleLog.push({message:i,type:e}),setTimeout(()=>{let n=document.getElementsByClassName("logs")[0];n&&(n.scrollTop=-n.scrollHeight)},100)}reset(){this.battleStarted=!1,this.battleLog=[],this.calculateStats(this.player),this.calculateStats(this.enemy)}home(){this.router.navigate(["/home"])}static \u0275fac=function(e){return new(e||c)(H($))};static \u0275cmp=N({type:c,selectors:[["app-simulator"]],decls:39,vars:22,consts:[[1,"sim-container"],[1,"glitch-title"],[1,"battle-arena"],[1,"fighter-card","player-side"],[1,"hp-bar-container"],[1,"hp-bar"],[1,"hp-text"],["class","stats-config",4,"ngIf"],[1,"derived-stats"],["class","actions",4,"ngIf"],[1,"vs"],[1,"fighter-card","enemy-side"],[1,"hp-bar","enemy-hp"],[1,"controls"],["class","btn-start",3,"click",4,"ngIf"],["class","btn-reset",3,"click",4,"ngIf"],[1,"console-log"],[1,"logs"],[3,"ngClass",4,"ngFor","ngForOf"],[1,"btn-home",3,"click"],[1,"stats-config"],[1,"stat-input"],["type","number",3,"ngModelChange","ngModel"],[1,"actions"],[1,"attack-selector"],[3,"ngModelChange","ngModel"],[3,"ngValue",4,"ngFor","ngForOf"],[1,"btn-action","attack",3,"click"],[1,"btn-action","heavy",3,"click"],[3,"ngValue"],[1,"btn-start",3,"click"],[1,"btn-reset",3,"click"],[3,"ngClass"],[1,"prefix"]],template:function(e,n){e&1&&(o(0,"main",0)(1,"h1",1),s(2,"Simulador de Combate"),a(),o(3,"div",2)(4,"div",3)(5,"h2"),s(6),a(),o(7,"div",4),k(8,"div",5),o(9,"span",6),s(10),a()(),y(11,ne,25,6,"div",7),o(12,"div",8)(13,"p"),s(14),a()(),y(15,re,10,3,"div",9),a(),o(16,"div",10),s(17,"VS"),a(),o(18,"div",11)(19,"h2"),s(20),a(),o(21,"div",4),k(22,"div",12),o(23,"span",6),s(24),a()(),y(25,oe,13,3,"div",7),o(26,"div",8)(27,"p"),s(28),a()()()(),o(29,"div",13),y(30,ae,2,0,"button",14)(31,le,2,0,"button",15),a(),o(32,"div",16)(33,"h3"),s(34,">> Registro de Combate_"),a(),o(35,"div",17),y(36,se,4,2,"p",18),a()(),o(37,"button",19),M("click",function(){return n.home()}),s(38," Voltar "),a()()),e&2&&(l(4),I("active-turn",n.battleStarted&&n.turnOrder[n.currentTurnIndex]===n.player),l(2),V(n.player.name),l(2),T("width",n.player.currentHp/n.player.maxHp*100,"%"),l(2),D("",n.player.currentHp," / ",n.player.maxHp," PV"),l(),_("ngIf",!n.battleStarted),l(3),v("\u{1F6E1}\uFE0F Defesa F\xEDsica: ",n.player.passiveDef),l(),_("ngIf",n.battleStarted&&n.turnOrder[n.currentTurnIndex]===n.player),l(3),I("active-turn",n.battleStarted&&n.turnOrder[n.currentTurnIndex]===n.enemy),l(2),V(n.enemy.name),l(2),T("width",n.enemy.currentHp/n.enemy.maxHp*100,"%"),l(2),D("",n.enemy.currentHp," / ",n.enemy.maxHp," PV"),l(),_("ngIf",!n.battleStarted),l(3),v("\u{1F6E1}\uFE0F Defesa F\xEDsica: ",n.enemy.passiveDef),l(2),_("ngIf",!n.battleStarted),l(),_("ngIf",n.battleStarted),l(5),_("ngForOf",n.battleLog))},dependencies:[z,L,B,R,Q,G,J,K,Y,q,j,U],styles:[".sim-container[_ngcontent-%COMP%]{padding:20px;min-height:100vh;display:flex;flex-direction:column;align-items:center;color:#fff;font-family:Roboto,sans-serif}.glitch-title[_ngcontent-%COMP%]{color:var(--accent-color);text-transform:uppercase;letter-spacing:2px;margin-bottom:30px}.battle-arena[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:flex-start;gap:20px;width:100%;max-width:900px;flex-wrap:wrap}.vs[_ngcontent-%COMP%]{font-size:2rem;font-weight:700;color:#ff00c8;align-self:center}.fighter-card[_ngcontent-%COMP%]{background-color:var(--card-bg);border:1px solid #444;border-radius:8px;padding:20px;width:300px;display:flex;flex-direction:column;gap:15px;transition:all .3s}.fighter-card.active-turn[_ngcontent-%COMP%]{border-color:#00fff9;box-shadow:0 0 15px #00fff94d;transform:scale(1.02)}.player-side[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#00fff9}.enemy-side[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#ef5350}.hp-bar-container[_ngcontent-%COMP%]{width:100%;height:25px;background-color:#333;border-radius:4px;position:relative;overflow:hidden}.hp-bar[_ngcontent-%COMP%]{height:100%;background-color:#00e676;transition:width .5s ease-out}.hp-bar.enemy-hp[_ngcontent-%COMP%]{background-color:#ef5350}.hp-text[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);font-size:.8rem;font-weight:700;text-shadow:1px 1px 2px black}.stats-config[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:10px;background:#0003;padding:10px;border-radius:4px}.stat-input[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.stat-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:40px;background:#111;border:1px solid #555;color:#fff;padding:4px;text-align:center;border-radius:4px}.attack-selector[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:5px;margin-bottom:5px}.attack-selector[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:.8rem;color:#aaa}.attack-selector[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{background-color:#111;color:#00fff9;border:1px solid var(--accent-color);padding:8px;border-radius:4px;font-family:inherit;cursor:pointer;outline:none}.attack-selector[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{box-shadow:0 0 5px var(--accent-color)}.actions[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:10px;margin-top:5px;animation:_ngcontent-%COMP%_fadeIn .3s ease}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(-5px)}to{opacity:1;transform:translateY(0)}}.btn-action[_ngcontent-%COMP%]{padding:12px;border:none;border-radius:4px;font-weight:700;cursor:pointer;text-transform:uppercase;transition:.2s}.btn-action.attack[_ngcontent-%COMP%]{background-color:var(--accent-color);color:#000}.btn-action.attack[_ngcontent-%COMP%]:hover{background-color:#fff;box-shadow:0 0 10px var(--accent-color)}.btn-action.heavy[_ngcontent-%COMP%]{background-color:#444;color:#fff;border:1px solid #666}.btn-action.heavy[_ngcontent-%COMP%]:hover{background-color:#555;border-color:#fff}.console-log[_ngcontent-%COMP%]{margin-top:30px;width:100%;max-width:800px;background-color:#0a0a0a;border:1px solid var(--accent-color);border-radius:4px;padding:15px;font-family:Courier New,monospace;height:200px;display:flex;flex-direction:column}.logs[_ngcontent-%COMP%]{overflow-y:auto;flex:1;display:flex;flex-direction:column-reverse}.logs[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:4px 0;font-size:.9rem;border-bottom:1px solid #222;padding-bottom:2px}.btn-start[_ngcontent-%COMP%]{margin-top:20px;padding:15px 40px;background-color:#ff00c8;color:#fff;border:none;font-size:1.2rem;font-weight:700;cursor:pointer;clip-path:polygon(10% 0,100% 0,100% 80%,90% 100%,0 100%,0 20%)}.btn-start[_ngcontent-%COMP%]:hover{background-color:#ff40d6;transform:scale(1.05)}.btn-reset[_ngcontent-%COMP%]{margin-top:20px;padding:10px 20px;background-color:#333;color:#aaa;border:1px solid #555;cursor:pointer}.console-log[_ngcontent-%COMP%]{margin-top:30px;width:100%;max-width:800px;background-color:#0a0a0a;border:1px solid var(--accent-color);border-radius:4px;padding:15px;font-family:Courier New,monospace;height:250px;display:flex;flex-direction:column;box-shadow:0 0 20px #00000080}.logs[_ngcontent-%COMP%]{overflow-y:auto;flex:1;display:flex;flex-direction:column-reverse;padding-right:5px}.logs[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:4px 0;font-size:.95rem;padding:4px 8px;border-radius:3px;line-height:1.4;border-left:3px solid transparent}.prefix[_ngcontent-%COMP%]{opacity:.5;margin-right:5px}.logs[_ngcontent-%COMP%]   p.player[_ngcontent-%COMP%]{color:#00fff9;background-color:#00fff90d;border-left-color:#00fff9}.logs[_ngcontent-%COMP%]   p.enemy[_ngcontent-%COMP%]{color:#ef5350;background-color:#ef53500d;border-left-color:#ef5350}.logs[_ngcontent-%COMP%]   p.system[_ngcontent-%COMP%]{color:#bbb;font-style:italic;font-size:.85rem}.logs[_ngcontent-%COMP%]   p.critical[_ngcontent-%COMP%]{color:gold;font-weight:700;text-shadow:0 0 5px rgba(255,215,0,.5);border-left-color:gold}.logs[_ngcontent-%COMP%]   p.fail[_ngcontent-%COMP%]{color:#777;text-decoration:line-through}.logs[_ngcontent-%COMP%]::-webkit-scrollbar{width:8px}.logs[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:var(--accent-color);border-radius:4px}.logs[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#111}.btn-home[_ngcontent-%COMP%]{margin-top:20px;padding:10px 20px;background-color:#222;color:#aaa;border:1px solid #555;cursor:pointer}.btn-home[_ngcontent-%COMP%]:hover{background-color:#333;color:#fff}@media (max-width: 700px){.battle-arena[_ngcontent-%COMP%]{flex-direction:column;align-items:center}.fighter-card[_ngcontent-%COMP%]{width:100%}}"]})};export{Z as Simulator};
